<div class="img-slot" id="ui-img-container">
    <img id="ui-img" src="" style="display:none; width:100%; height:100%; object-fit: contain;">
    <span id="ui-img-loader">FINDING ARTWORK...</span>
</div>

<script>
    const params = new URLSearchParams(window.location.search);
    const cardId = params.get('id');

    fetch('card_data.json')
        .then(res => res.json())
        .then(data => {
            const searchId = decodeURIComponent(cardId).trim();
            const card = data.find(c => String(c['Unique Code']).trim() === searchId);

            if (card) {
                // 1. FILL TEXT DATA (From your manual file)
                document.getElementById('ui-name').innerText = card['Product Name'];
                document.getElementById('ui-set').innerText = `#${card['Card Number']} | ${card['Set']}`;
                document.getElementById('ui-grade').innerText = `${card['Grade']} | ${card['Card Condition']}`;
                
                const price = (card['My Sales Price'] && card['My Sales Price'] !== "TBD") ? card['My Sales Price'] : card['Suggested Selling Price (Fair Market)'];
                document.getElementById('ui-price').innerText = price;

                // 2. FETCH IMAGE DATA (The "Walking" API call)
                // We search by Name and Card Number to get the exact artwork
                const cleanName = card['Product Name'].split('(')[0].trim(); // Removes the (80) for better searching
                const searchUrl = `https://api.pokemontcg.io/v2/cards?q=name:"${cleanName}" number:"${card['Card Number']}"`;

                fetch(searchUrl)
                    .then(response => response.json())
                    .then(artData => {
                        if (artData.data && artData.data.length > 0) {
                            const imgUrl = artData.data[0].images.large;
                            const imgElement = document.getElementById('ui-img');
                            imgElement.src = imgUrl;
                            imgElement.style.display = 'block';
                            document.getElementById('ui-img-loader').style.display = 'none';
                        } else {
                            document.getElementById('ui-img-loader').innerText = "NO IMAGE FOUND";
                        }
                    })
                    .catch(() => {
                        document.getElementById('ui-img-loader').innerText = "IMAGE ERROR";
                    });

            } else {
                document.getElementById('ui-name').innerText = "Card Not Found";
            }
        });
</script>
